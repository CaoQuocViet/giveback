// Cú pháp dbdiagram theo tiêu chuẩn:
//     + Tên bảng: PascalCase
//     + Tên cột: snake_case
//     + Kiểu dữ liệu: lowercase
//     + Ràng buộc: UPPERCASE

// Enum definitions
Enum VaiTro {
  QUANTRIVIEN
  NGUOIDONGGOP
  TOCHUCTUTHIEN
  NGUOINHANHOTRO
}

Enum TrangThaiChienDich {
  KHOIDONG
  DANGKEUGOI
  DADONG
  DAKETTHUC
}

Enum TrangThaiXacThuc {
  DANGCHO
  DAXACTHUC
  TUCHOI
}

Enum TrangThaiThanhToan {
  DANGCHO
  THANHCONG
  THATBAI
}

// Base tables
Table NguoiDung {
  id varchar [PK]
  ho_ten varchar
  email varchar [UNIQUE]
  so_dien_thoai varchar [UNIQUE]
  mat_khau varchar
  vai_tro VaiTro
  anh_dai_dien varchar
  tinh varchar
  quan_huyen varchar
  xa_phuong varchar
  dia_chi_chi_tiet varchar
  thoi_gian_tao timestamp
  thoi_gian_cap_nhat timestamp
}

Table QuanTriVien {
  id varchar [PK, ref: > NguoiDung.id]
  la_quan_tri_he_thong boolean
}

Table ToChucTuThien {
  id varchar [PK, ref: > NguoiDung.id]
  giay_phep_url varchar // URLs của ảnh xác minh
  trang_thai_xac_thuc TrangThaiXacThuc
  diem_danh_gia decimal
  so_chien_dich int [default: 0] // Tổng số chiến dịch đã tạo
  tong_so_tien_huy_dong decimal [default: 0] // Tổng số tiền đã huy động được
  thoi_gian_tao timestamp
  thoi_gian_cap_nhat timestamp // Thời điểm cập nhật thống kê gần nhất
}

Table ChienDich {
  id varchar [PK]
  id_to_chuc varchar [ref: > ToChucTuThien.id]
  tieu_de varchar
  mo_ta text
  trang_thai TrangThaiChienDich
  ngan_sach_du_kien decimal
  so_tien_hien_tai decimal
  ngay_bat_dau timestamp
  ngay_ket_thuc timestamp
  tinh varchar
  quan_huyen varchar
  xa_phuong varchar
  dia_chi_chi_tiet varchar
  anh_chien_dich varchar[] // URLs của ảnh chiến dịch
}

Table LoaiThanhToan {
  id varchar [PK]
  ten varchar
  ma_thanh_toan varchar
}

Table DongGop {
  id varchar [PK]
  id_chien_dich varchar [ref: > ChienDich.id]
  id_nguoi_dong_gop varchar [ref: > NguoiDung.id]
  id_loai_thanh_toan varchar [ref: > LoaiThanhToan.id]
  so_tien decimal
  ghi_chu text
  trang_thai TrangThaiThanhToan
  thoi_gian_tao timestamp
  thoi_gian_cap_nhat timestamp
}

Table HoTro {
  id varchar [PK]
  id_chien_dich varchar [ref: > ChienDich.id]
  so_tien decimal
  thoi_gian_phan_phoi timestamp
  tinh varchar
  quan_huyen varchar
  xa_phuong varchar
  dia_chi_chi_tiet varchar
  anh_minh_chung varchar[] // URLs của ảnh minh chứng
}

Table BinhLuan {
  id varchar [PK]
  id_chien_dich varchar [ref: > ChienDich.id]
  id_nguoi_dung varchar [ref: > NguoiDung.id]
  noi_dung text
  vai_tro VaiTro // Cờ role
  thoi_gian_tao timestamp
  thoi_gian_cap_nhat timestamp
}