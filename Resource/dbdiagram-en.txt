// Syntax standards for dbdiagram:
//     + Table names: PascalCase
//     + Column names: snake_case
//     + Data types: lowercase
//     + Constraints: UPPERCASE

// Enums
Enum Role {
  ADMIN
  DONOR
  CHARITY
  BENEFICIARY
}

Enum CampaignStatus {
  STARTING
  ONGOING
  CLOSED
  COMPLETED
}

Enum VerificationStatus {
  PENDING
  VERIFIED
  REJECTED
}

Enum PaymentStatus {
  PENDING
  SUCCESS
  FAILED
}

// Tables
Table Users {
  id varchar [pk]
  full_name varchar [not null]
  email varchar [unique, not null]
  phone varchar [unique, not null]
  password varchar [not null]
  role Role [not null]
  avatar varchar
  province varchar
  district varchar
  ward varchar
  address varchar
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
}

Table Admins {
  id varchar [pk, ref: > Users.id]
  is_system_admin boolean [not null, default: false]
}

Table Charities {
  id varchar [pk, ref: > Users.id]
  title varchar [not null]
  description text
  license_description text
  license_image_url varchar [not null]
  verification_status VerificationStatus [not null, default: 'PENDING']
  rating decimal [default: 0]
  campaign_count int [default: 0]
  total_raised decimal [default: 0]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
}

Table Campaigns {
  id varchar [pk]
  charity_id varchar [ref: > Charities.id]
  title varchar [not null]
  description text
  detail_goal text
  status CampaignStatus [not null, default: 'STARTING']
  rating decimal [default: 0]
  target_amount decimal [not null]
  current_amount decimal [default: 0]
  start_date timestamp [not null]
  end_date timestamp [not null]
  province varchar
  district varchar
  ward varchar
  address varchar
  images varchar[] [default: '{}']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
}

Table PaymentMethods {
  id varchar [pk]
  name varchar [not null]
  transaction_code varchar [not null, unique]
}

Table Donations {
  id varchar [pk]
  campaign_id varchar [ref: > Campaigns.id]
  donor_id varchar [ref: > Users.id]
  payment_method_id varchar [ref: > PaymentMethods.id]
  amount decimal [not null]
  note text
  status PaymentStatus [not null, default: 'PENDING']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
}

Table Distributions {
  id varchar [pk]
  campaign_id varchar [ref: > Campaigns.id]
  amount decimal [not null]
  distribution_date timestamp [not null]
  province varchar
  district varchar
  ward varchar
  address varchar
  proof_images varchar[] [default: '{}']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
}

Table Comments {
  id varchar [pk]
  campaign_id varchar [ref: > Campaigns.id]
  user_id varchar [ref: > Users.id]
  content text [not null]
  role Role [not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
}